<script src="//maps.google.com/maps/api/js?v=3.18&sensor=false&client=&key=&libraries=geometry&language=&hl=&region="></script> 
<script src="//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.9/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->


<div class="row page-title">
    <div class="container clear-padding text-center">
      <h3><%= @apartment.title  %> </h3>
      <h5>
        <i class="fa fa-star"></i>
        <i class="fa fa-star"></i>
        <i class="fa fa-star"></i>
        <i class="fa fa-star"></i>
        <i class="fa fa-star-o"></i>
      </h5>
    </div>
  </div>


  <!-- END: PAGE TITLE -->
  <div class="row">
    <div class="container" style="padding-top:20px">
      <div class="main-content col-md-8">
          <!-- START: ROOM GALLERY -->
        <div id="myCarousel" class="carousel slide" data-ride="carousel">
          <!-- Carousel indicators -->
      <%if @apartment.pictures.count > 1 %>
        <ol class="carousel-indicators">
          <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
          <%for i in 1..@apartment.pictures.count-1%>
            <li data-target="#myCarousel" data-slide-to=<%= "#{i}" %>></li>
          <%end%>
        </ol> 
      <%end%>
          <!-- Wrapper for carousel items -->
          <div class="carousel-inner">
            <%unless @apartment.pictures.empty?%>
                <% @apartment.pictures.each do |pic| %>
                  <%if pic == @apartment.pictures.first%>
                    <div class="active item">
                      <%= image_tag pic.image.url, class:"apartment-carousel" %>
                    </div>
                  <%else%>
                    <div class="item">
                      <%= image_tag pic.image.url, class:"apartment-carousel" %>
                    </div>
                  <% end %>
                <% end %>
            <%else%>
              <div class="active item">
                <%= image_tag("offer1.jpg", :alt => "No tiene foto", class:"apartment-carousel") %>
              </div>
            <%end%>
          </div>
          <!-- Carousel controls -->
          <%if @apartment.pictures.count > 1 %>
            <a id="carousel-arrows"class="carousel-control left" href="#myCarousel" data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left"></span>
            </a>
            <a id="carousel-arrows" class="carousel-control right" href="#myCarousel" data-slide="next">
                <span class="glyphicon glyphicon-chevron-right"></span>
            </a>
          <%end%>
      </div>
        <!-- END: ROOM GALLERY -->
        <div class="room-ammenties">
          <div class="col-md-2 col-sm-2">
            <h3 class="custom-head">Hotel Facilities</h3>
          </div>
          <div class="col-md-10 col-sm-10 hotel-room-detail">
            <div class="ammenties-1">
              <div class="col-md-6 col-sm-6">
                <p><i class="fa fa-wifi"></i>Pieza(s): <%=@apartment.rooms%> </p>
              </div>
              <div class="col-md-6 col-sm-6">
                <p><i class="fa fa-cutlery"></i>Baño(s): <%=@apartment.bathrooms%></p>
              </div>
              <div class="col-md-6 col-sm-6">
                <p><i class="fa fa-glass"></i>Precio: <%=@apartment.price%></p>
              </div>
            </div>
          </div>
        </div>
        <div class="hr-seperator"></div>
        <div class="hotel-room-desc">
          <div class="col-md-2 col-sm-2">
            <h3 class="custom-head">Room Details</h3>
          </div>
          <div class="col-md-10 col-sm-10 hotel-room-detail">
            <p><%= @apartment.description%> </p>
          </div>
        </div>

      </div>  
      <div class="col-md-4 hotel-detail-sidebar">
        <div class="col-md-12 sidebar-wrapper clear-padding">
          <div class="sidebar-booking-box" style="padding-top:20px">
            <h3 class="text-center">MAKE A BOOKING</h3>
            <div class="booking-box-body">
              <form >
                <div class="col-md-6 col-sm-6 col-xs-6">
                  <label>Check In</label>
                  <div class="input-group margin-bottom-sm">
                    <input type="text" id="check_in" name="check_in" class="form-control" placeholder="DD/MM/YYYY">
                    <span class="input-group-addon"><i class="fa fa-calendar fa-fw"></i></span>
                  </div>
                </div>
                <div class="col-md-6 col-sm-6 col-xs-6">
                  <label>Check Out</label>
                  <div class="input-group margin-bottom-sm">
                    <input type="text" id="check_out" name="check_out" class="form-control" placeholder="DD/MM/YYYY">
                    <span class="input-group-addon"><i class="fa fa-calendar fa-fw"></i></span>
                  </div>
                </div>
                <div class="col-md-4 col-sm-4 col-xs-4">
                  <label>Rooms</label>
                  <select class="selectpicker" name="rooms">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                  </select>
                </div>
                <div class="col-md-4 col-sm-4 col-xs-4">
                  <label>Adult</label>
                  <select class="selectpicker" name="adult">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                  </select>
                </div>
                <div class="col-md-4 col-sm-4 col-xs-4">
                  <label>Child</label>
                  <select class="selectpicker" name="child">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                  </select>
                </div>
                <div class="room-price">
                  <div class="col-md-8 col-sm-8 col-xs-8">
                    <label><input type="checkbox" name="single"><span>Deluxe Single Room</span></label>
                  </div>
                  <div class="col-md-4 col-sm-4 col-xs-4">
                    <h5><%=@apartment.price%>/Night</h5>
                  </div>
                </div>
                <div class="clearfix"></div>
                <div class="room-price">
                  <div class="col-md-8 col-sm-8 col-xs-8">
                    <label><input type="checkbox" name="double"><span>Deluxe Double Room</span></label>
                  </div>
                  <div class="col-md-4 col-sm-4 col-xs-4">
                    <h5>$199/Night</h5>
                  </div>
                </div>
                <div class="clearfix"></div>
                <div class="room-price">
                  <div class="col-md-8 col-sm-8 col-xs-8">
                    <label><input type="checkbox" name="royal"><span>Royal Suite</span></label>
                  </div>
                  <div class="col-md-4 col-sm-4 col-xs-4">
                    <h5>$299/Night</h5>
                  </div>
                </div>
                <div class="clearfix"></div>
                <div class="grand-total text-center">
                  <div class="col-md-6 col-sm-6 col-xs-6">
                    <h4>Total $599</h4>
                  </div>
                  <div class="col-md-6 col-sm-6 col-xs-6">
                    <button type="submit">BOOK</button>
                  </div>
                </div>
              </form>
            </div>
          </div>
          <div class="sidebar-assistance-box">
            <h3 class="text-center">NEED ASSISTANCE</h3>
            <div class="assistance-box-body text-center">
              <h5>Need Help? Call Us</h5>
              <h4>+91 1234567890</h4>
            </div>
          </div>
        </div>
      </div>
        <div class="col-md-12 hotel-room-desc">
          <div class="col-md-2 col-sm-2">
            <h3 class="custom-head">Ubicación</h3>
            <p><%=@apartment.address%></p>            
          </div>
          <div class="col-md-10 col-sm-10 hotel-room-detail">
            <div id="map" style='width: 100%; height: 300px;'></div>
  <script type="text/javascript">
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}},
    function(){
      markers = handler.addMarkers(<%=raw @hash.to_json %>);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
      handler.getMap().setZoom(16);
    });
  </script>
          </div>
        </div>
    </div>
  </div>

  <!-- START: SIMILAR ROOMS -->
  <div class="row similar-room">
    <div class="container clear-padding">
      <div class="hotel-listing text-center">
        <h2>Propiedades cerca de esta:</h2>
        <!-- START: HOTEL GRID VIEW -->
        <%contador=0%><!--Propiedades que cumplen con las condiciones-->
        <div id="owl-demo">
        <%Apartment.publicados.each do |a|%>
        <%if a.geocoded?%>
        <%unless a.address==@apartment.address%>
        <%if @apartment.distance_from([a.latitude,a.longitude]) < 10%>
        <%contador+=1%>
        <div class="room-grid-view wow slideInUp">
        <%if a.pictures.empty? %>
          <div class="crop">
            <%= image_tag("offer1.jpg", :alt => "No tiene foto") %>
          </div>
        <%else%>
          <div class="crop">
            <%= image_tag a.pictures.first.image.url %>
          </div>
        <%end%>
          <div class="room-info">
            <div class="post-title">
              <h5><%=a.title%></h5>
              <p><i class="fa fa-calendar"></i> <%=a.created_at%></p>
              <p><i class="fa fa-map-signs"></i> <%=a.address%></p>
              <p><i class="fa fa-road"></i> <%=@apartment.distance_from([a.latitude,a.longitude]).round(2)%> (KM)</p>
            </div>
            <div class="post-desc">
              <p><%=a.description%></p>
            </div>
            <div class="room-book">
              <div class="col-md-8 col-sm-6 col-xs-6 clear-padding post-alt">
                <h5><i class="fa fa-comments"></i> 2 <i class="fa fa-share-alt"></i> 20 </h5>
              </div>
              <div class="col-md-4 col-sm-6 col-xs-6 clear-padding">
                <a href="#" class="text-center"><%=link_to "Ver",a%></a> 
              </div>
            </div>
            <div class="clearfix"></div>
          </div>
        </div>
        <%end%>
        <%end%>
        <%end%>
        <%end%>
        <%if contador == 0%>
    <h4>Recorrimos 10 kilometros alrededor de esta propiedad y no encontramos otra cerca <i class="fa fa-thumbs-down"></i></h4>
  <%end%>
      </div>   <!--FIN OWL-->

       <script>
    $(document).ready(function() {
      $("#owl-demo").owlCarousel({
          autoPlay: 3000, //Set AutoPlay to 3 seconds
          items : 3,
          itemsDesktop : [1199,3],
          itemsDesktopSmall : [979,3],
          loop: true
      });
    });
</script> 

<script>
  new WOW().init();
</script>
        <div class="clearfix-sm"></div>
        
      <!-- END: ROOM GRID VIEW -->
    </div> 
  </div>
 </div>  